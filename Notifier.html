<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grow a Garden Notifier</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f0f11;
      --bg2: #1a1a1f;
      --text: #f0f0f0;
      --accent: #ffde59;
      --muted: #888;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    header {
      background: var(--bg2);
      padding: 1rem;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      border-bottom: 1px solid #222;
      position: sticky;
      top: 0;
      z-index: 999;
    }
    .category-tab {
      background: none;
      border: none;
      color: var(--text);
      padding: 0.5rem 1rem;
      margin: 0.25rem;
      cursor: pointer;
      border-radius: 0.5rem;
      transition: background 0.2s;
    }
    .category-tab.active {
      background: var(--accent);
      color: #000;
    }
    .item-list {
      display: flex;
      flex-wrap: wrap;
      padding: 1rem;
      justify-content: center;
      gap: 1rem;
    }
    .item-card {
      background: var(--bg2);
      padding: 1rem;
      border-radius: 1rem;
      width: 180px;
      text-align: center;
      position: relative;
      transition: box-shadow 0.3s;
    }
    .item-card img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      margin-bottom: 0.5rem;
    }
    .item-card.weather.active {
      box-shadow: 0 0 15px 3px var(--accent);
    }
    .item-card.merchant.empty::after {
      content: 'Merchant has not arrived';
      display: block;
      color: var(--muted);
      font-size: 0.9rem;
      margin-top: 0.5rem;
    }
    .restock-bar {
      text-align: center;
      padding: 0.5rem;
      background: var(--bg2);
      border-bottom: 1px solid #222;
    }
  </style>
</head>
<body>
  <header>
    <button class="category-tab" data-tab="seeds">Seeds</button>
    <button class="category-tab" data-tab="gears">Gears</button>
    <button class="category-tab" data-tab="eggs">Eggs</button>
    <button class="category-tab" data-tab="weather">Weather</button>
    <button class="category-tab" data-tab="event">Event</button>
    <button class="category-tab" data-tab="merchant">Merchant</button>
  </header>
  <div class="restock-bar" id="restockBar"></div>
  <div class="item-list" id="itemList"></div>

  <script>
    const itemListEl = document.getElementById("itemList");
    const restockBar = document.getElementById("restockBar");
    const TABS = ['seeds', 'gears', 'eggs', 'weather', 'event', 'merchant'];
    let currentTab = 'seeds';

    const SEEDS = ["Carrot", "Strawberry", "Blueberry", "Tomato", "Daffodil", "Watermelon", "Pumpkin", "Apple", "Bamboo", "Coconut", "Cactus", "Dragon Fruit", "Mango", "Grape", "Mushroom", "Pepper", "Cacao", "Beanstalk", "Ember lily", "Sugar Apple", "Burning Bud", "Giant Pinecone", "Elder Strawberry"];
    const GEARS = ["Watering Can", "Trowel", "Recall Wrench", "Basic Sprinkler", "Advanced Sprinkler", "Medium Toy", "Medium Treat", "Godly Sprinkler", "Magnifying Glass", "Tanning Mirror", "Master Sprinkler", "Cleaning Spray", "Favorite Tool", "Harvest Tool", "Friendship Pot", "Levelup Lolipop"];
    const EGGS = ["Common Egg", "Common Summer Egg", "Rare Summer Egg", "Mythical Egg", "Paradise Egg", "Bug Egg"];
    const EVENTS = ["Zen Seed Pack", "Zen Egg", "Hot Springs", "Zen Sand", "Tranquil Radar", "Zenflare", "Zen Crate", "Sakura Bush", "Soft Sunshine", "Koi", "Zen Gnome Crate", "Spiked Mango", "Pet Shard Tranquil", "Pet Shard Corrupted", "Raiju"];

    function formatCountdown(ms) {
      const t = Math.max(0, Math.floor(ms / 1000)), d = Math.floor(t / 86400), h = Math.floor(t % 86400 / 3600), m = Math.floor(t % 3600 / 60), s = t % 60, p = [];
      if (d) p.push(d + 'd'); if (h) p.push(h + 'h'); if (m) p.push(m + 'm'); if (!p.length || s) p.push(s + 's');
      return p.join(' ');
    }

    function calculateRestock() {
      const now = new Date(), today = new Date(now.getFullYear(), now.getMonth(), now.getDate()), n = i => today.getTime() + Math.ceil((now.getTime() - today.getTime()) / i) * i;
      return {
        seeds: n(300000),
        gears: n(300000),
        eggs: n(1800000),
        events: n(3600000),
        merchant: n(14400000),
      };
    }

    const restockTimes = calculateRestock();

    function updateRestockBar() {
      const now = Date.now();
      const t = formatCountdown(restockTimes[currentTab] - now);
      restockBar.textContent = `Next ${currentTab.charAt(0).toUpperCase() + currentTab.slice(1)} Restock: ${t}`;
    }

    function renderList() {
      itemListEl.innerHTML = "";
      const list = {
        seeds: SEEDS,
        gears: GEARS,
        eggs: EGGS,
        weather: ["Sunny", "Rainy", "Windy", "Snowy"],
        event: EVENTS,
        merchant: [] // can be filled dynamically from API or data later
      }[currentTab];

      if (currentTab === 'merchant' && list.length === 0) {
        const card = document.createElement('div');
        card.className = 'item-card merchant empty';
        itemListEl.appendChild(card);
        return;
      }

      list.forEach(name => {
        const card = document.createElement('div');
        card.className = `item-card ${currentTab}`;
        const img = document.createElement('img');
        img.src = `https://api.joshlei.com/v2/growagarden/image/${encodeURIComponent(name)}`;
        img.onerror = () => img.style.display = 'none';
        card.appendChild(img);
        const title = document.createElement('div');
        title.textContent = name;
        card.appendChild(title);
        if(currentTab === 'weather') card.classList.add('active');
        itemListEl.appendChild(card);
      });
    }

    document.querySelectorAll('.category-tab').forEach(btn => {
      btn.onclick = () => {
        currentTab = btn.dataset.tab;
        document.querySelectorAll('.category-tab').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderList();
        updateRestockBar();
      };
    });

    renderList();
    updateRestockBar();
    setInterval(updateRestockBar, 1000);
  </script>
</body>
</html>
